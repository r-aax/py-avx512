{
	r0 = _mm512_load_ps(&xl[i]);
	r1 = _mm512_load_ps(&xr[i]);
	r2 = _mm512_load_ps(&yl[i]);
	r3 = _mm512_load_ps(&yr[i]);
	r4 = _mm512_load_ps(&zl[i]);
	r5 = _mm512_load_ps(&zr[i]);
	r6 = _mm512_load_ps(&sph_x[i]);
	r7 = _mm512_load_ps(&sph_y[i]);
	r8 = _mm512_load_ps(&sph_z[i]);
	r9 = _mm512_load_ps(&sph_r[i]);
	r11 = _mm512_sub_ps(r0, r6);
	r12 = _mm512_sub_ps(r0, r6);
	r13 = _mm512_mul_ps(r11, r12);
	r10 = r13;
	r15 = _mm512_sub_ps(r1, r6);
	r16 = _mm512_sub_ps(r1, r6);
	r17 = _mm512_mul_ps(r15, r16);
	r14 = r17;
	r19 = _mm512_sub_ps(r2, r7);
	r20 = _mm512_sub_ps(r2, r7);
	r21 = _mm512_mul_ps(r19, r20);
	r18 = r21;
	r23 = _mm512_sub_ps(r3, r7);
	r24 = _mm512_sub_ps(r3, r7);
	r25 = _mm512_mul_ps(r23, r24);
	r22 = r25;
	r27 = _mm512_sub_ps(r4, r8);
	r28 = _mm512_sub_ps(r4, r8);
	r29 = _mm512_mul_ps(r27, r28);
	r26 = r29;
	r31 = _mm512_sub_ps(r5, r8);
	r32 = _mm512_sub_ps(r5, r8);
	r33 = _mm512_mul_ps(r31, r32);
	r30 = r33;
	r35 = _mm512_mul_ps(r9, r9);
	r34 = r35;
	r37 = _mm512_add_ps(r10, r18);
	r38 = _mm512_add_ps(r37, r26);
	p0 = _mm512_cmplte_ps_mask(r38, r34)
	r40 = _mm512_add_ps(r10, r18);
	r41 = _mm512_add_ps(r40, r30);
	p1 = _mm512_cmplte_ps_mask(r41, r34)
	r43 = _mm512_add_ps(r10, r22);
	r44 = _mm512_add_ps(r43, r26);
	p4 = _mm512_cmplte_ps_mask(r44, r34)
	r46 = _mm512_add_ps(r10, r22);
	r47 = _mm512_add_ps(r46, r30);
	p7 = _mm512_cmplte_ps_mask(r47, r34)
	r49 = _mm512_add_ps(r14, r18);
	r50 = _mm512_add_ps(r49, r26);
	p10 = _mm512_cmplte_ps_mask(r50, r34)
	r52 = _mm512_add_ps(r14, r18);
	r53 = _mm512_add_ps(r52, r30);
	p13 = _mm512_cmplte_ps_mask(r53, r34)
	r55 = _mm512_add_ps(r14, r22);
	r56 = _mm512_add_ps(r55, r26);
	p16 = _mm512_cmplte_ps_mask(r56, r34)
	r58 = _mm512_add_ps(r14, r22);
	r59 = _mm512_add_ps(r58, r30);
	p19 = _mm512_cmplte_ps_mask(r59, r34)
	r61 = _mm512_add_ps(r36, r39);
	r62 = _mm512_add_ps(r61, r42);
	r63 = _mm512_add_ps(r62, r45);
	r64 = _mm512_add_ps(r63, r48);
	r65 = _mm512_add_ps(r64, r51);
	r66 = _mm512_add_ps(r65, r54);
	r67 = _mm512_add_ps(r66, r57);
	r60 = r67;
	r69 = _mm512_add_ps(r0, r1);
	r70 = _mm512_div_ps(r69, c.2.0);
	r68 = r70;
	r72 = _mm512_add_ps(r2, r3);
	r73 = _mm512_div_ps(r72, c.2.0);
	r71 = r73;
	r75 = _mm512_add_ps(r4, r5);
	r76 = _mm512_div_ps(r75, c.2.0);
	r74 = r76;
	p22 = _mm512_cmpeq_ps_mask(r60, c.0.0)

	p2 = _mm512_mask_cmpge_ps_mask(p2, p0, c.1, c.0)
	p28 = p0 & p2;
	p29 = ~p0;

	p3 = _mm512_mask_cmpge_ps_mask(p3, p29, c.1, c.0)
	p30 = p29 & p3;
	p43 = p30 & p28;
	p40 = p30 & p28;
	p37 = p28 & p1;
	p42 = p30 & p37;
	p36 = p28 & p1;
	p41 = p30 & p36;

	p5 = _mm512_mask_cmpge_ps_mask(p5, p42, c.1, c.0)
	p32 = p1 & p5;
	p38 = p28 & p32;
	p44 = p30 & p38;
	p57 = p34 & p44;
	p54 = p34 & p44;
	p51 = p44 & p4;
	p56 = p34 & p51;
	p50 = p44 & p4;
	p55 = p34 & p50;

	p8 = _mm512_mask_cmpge_ps_mask(p8, p56, c.1, c.0)
	p46 = p4 & p8;
	p52 = p44 & p46;
	p58 = p34 & p52;
	p71 = p48 & p58;
	p68 = p48 & p58;
	p65 = p58 & p7;
	p70 = p48 & p65;
	p64 = p58 & p7;
	p69 = p48 & p64;

	p11 = _mm512_mask_cmpge_ps_mask(p11, p70, c.1, c.0)
	p60 = p7 & p11;
	p66 = p58 & p60;
	p72 = p48 & p66;
	p85 = p62 & p72;
	p82 = p62 & p72;
	p79 = p72 & p10;
	p84 = p62 & p79;
	p78 = p72 & p10;
	p83 = p62 & p78;

	p14 = _mm512_mask_cmpge_ps_mask(p14, p84, c.1, c.0)
	p74 = p10 & p14;
	p80 = p72 & p74;
	p86 = p62 & p80;
	p99 = p76 & p86;
	p96 = p76 & p86;
	p93 = p86 & p13;
	p98 = p76 & p93;
	p92 = p86 & p13;
	p97 = p76 & p92;

	p17 = _mm512_mask_cmpge_ps_mask(p17, p98, c.1, c.0)
	p88 = p13 & p17;
	p94 = p86 & p88;
	p100 = p76 & p94;
	p113 = p90 & p100;
	p110 = p90 & p100;
	p107 = p100 & p16;
	p112 = p90 & p107;
	p106 = p100 & p16;
	p111 = p90 & p106;

	p20 = _mm512_mask_cmpge_ps_mask(p20, p112, c.1, c.0)
	p102 = p16 & p20;
	p108 = p100 & p102;
	p114 = p90 & p108;
	p127 = p104 & p114;
	p124 = p104 & p114;
	p121 = p114 & p19;
	p126 = p104 & p121;
	p120 = p114 & p19;
	p125 = p104 & p120;

	p25 = _mm512_mask_cmpge_ps_mask(p25, p126, c.1, c.0)
	p116 = p19 & p25;
	p122 = p114 & p116;
	p128 = p104 & p122;
	p142 = p118 & p128;
	p140 = p128 & p22;
	p143 = p118 & p140;
	_mm512_mask_store_ps(&kind[i], p143, c.0.0);
}
